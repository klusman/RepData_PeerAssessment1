debugSource('~/_WEER/source/__07__Htops_07.R')
source('~/_WEER/source/__07__Htops_07.R')
source('~/_WEER/source/__07__Htops_07.R')
source('~/_WEER/source/__07__Htops_07.R')
system.time(Htops_07(ActualDataPath = "~/_WEER/TG_NONblend",
Ywindow=c(100, 300),  # length of the timeseries
Hreport=c(9500, 10000), # the H tops reported on
SameTops=2, # how many tops the same to report
basename="__Htops_" ) )
index_Hscale
i
r
x1
source('~/_WEER/source/__07__Htops_07.R')
source('~/_WEER/source/__07__Htops_07.R')
source('~/_WEER/source/__07__Htops_07.R')
source('~/_WEER/source/__07__Htops_07.R')
system.time(Htops_07(ActualDataPath = "~/_WEER/TG_NONblend",
Ywindow=c(100, 300),  # length of the timeseries
Hreport=c(100, 100000), # the H tops reported on
SameTops=6, # how many tops the same to report
basename="__Htops_" ) )
system.time(Htops_07(ActualDataPath = "~/_WEER/TG_NONblend",
Ywindow=c(100, 300),  # length of the timeseries
Hreport=c(100, 100000), # the H tops reported on
SameTops=5, # how many tops the same to report
basename="__Htops_" ) )
source('~/_WEER/source/__07__Htops_07.R')
source('~/_WEER/source/__07__Htops_07.R')
source('~/_WEER/source/__07__Htops_07.R')
source('~/_WEER/source/__07__Htops_07.R')
source('~/_WEER/source/__07__Htops_07.R')
source('~/_WEER/source/__07__Htops_07.R')
system.time(Htops_07(ActualDataPath = "~/_WEER/TG_NONblend",
Ywindow=c(100, 300),  # length of the timeseries
Hreport=c(100, 100000), # the H tops reported on
SameTops=6, # how many tops the same to report
basename="" ) )
source('~/_WEER/source/__01__Mk_01.R')
source('~/_WEER/source/__02__Mk_02.R')
source('~/_WEER/source/__03__Mk_03.R')
source('~/_WEER/source/__05__Mk_05.R')
source('~/_WEER/source/__05__Mk_05.R')
source('~/_WEER/source/__05__Plt_05.R')
source('~/_WEER/source/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TG_NONblend",H_range=c(0.7, 0.8)))
source('~/_WEER/source/__05__Plt_05.R')
system.time(   Plt_05("~/_WEER/TG_NONblend", # where is the _DoList file
N=20,  # maximum of plots made
Hreport=NULL,  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c("file", "screen") )  # c("file", "screen") for both
)
source('~/_WEER/source/__05__Mk_05.R')
source('~/_WEER/source/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TG_NONblend",H_range=c(10, 100000)))
source('~/_WEER/source/__01__Mk_01.R')
system.time(Mk_01("~/_WEER/TG_NONblend"))
source('~/_WEER/source/__02__Mk_02.R')
system.time(Mk_02("~/_WEER/TG_NONblend"))
source('~/_WEER/source/__03__Mk_03.R')
system.time(Mk_03("~/_WEER/TG_NONblend", windows=c(801, 1601, 3201), screen=FALSE))
system.time(Mk_05("~/_WEER/TG_NONblend",H_range=c(10, 100000)))
system.time(Mk_05("~/_WEER/TG_NONblend",H_range=c(1.9, 10)))
source('~/_WEER/source/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TG_NONblend",H_range=c(3.9, 10)))
source('~/_WEER/source/__06__Mk_06.R')
system.time(Mk_06("~/_WEER/TG_NONblend"))
source('~/_WEER/source/__06__Mk_06.R')
system.time(Mk_06("~/_WEER/TG_NONblend"))
source('~/_WEER/source/__06__Plt_06.R')
c() -> aap
aap[1]
length(aap)
0 -> aap[1]
length(aap)
source('~/_WEER/source/__06__Plt_06.R')
system.time(   Plt_06("~/_WEER/TG_NONblend", # where is the _DoList file
N=20,  # how many plots must be made
Hreport = NULL,  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c("file", "screen") )  # c("file", "screen") for both
)
source('~/_WEER/source/__06__Plt_06.R')
source('~/_WEER/source/__06__Mk_06.R')
system.time(Mk_06("~/_WEER/TG_NONblend"))
source('~/_WEER/source/__06__Mk_06.R')
system.time(Mk_06("~/_WEER/TG_NONblend"))
source('~/_WEER/source/__06__Plt_06.R')
system.time(Mk_05("~/_WEER/TG_NONblend",H_range=c(100, 200)))
source('~/_WEER/source/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TG_NONblend",H_range=c(100, 200)))
source('~/_WEER/source/__06__Mk_06.R')
system.time(Mk_06("~/_WEER/TG_NONblend"))
source('~/_WEER/source/__06__Mk_06.R')
source('~/_WEER/source/__06__Plt_06.R')
source('~/_WEER/source/__06__Plt_06.R')
system.time(   Plt_06("~/_WEER/TG_NONblend", # where is the _DoList file
N=30,  # how many plots must be made
Hreport = c(0, 10),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_06("~/_WEER/TG_NONblend", # where is the _DoList file
N=20,  # how many plots must be made
Hreport = c(2.5, 3.5),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_06("~/_WEER/TG_NONblend", # where is the _DoList file
N=20,  # how many plots must be made
Hreport = c(3.5, 4.5),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
source('~/_WEER/source/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TG_NONblend",H_range=c(0.65, 0.7)))
source('~/_WEER/source/__06__Mk_06.R')
system.time(Mk_06("~/_WEER/TG_NONblend"))
source('~/_WEER/source/__06__Plt_06.R')
system.time(   Plt_06("~/_WEER/TG_NONblend", # where is the _DoList file
N=20,  # how many plots must be made
Hreport = NULL,  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
source('~/_WEER/source/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TG_NONblend",H_range=c(0.55, 0.65)))
source('~/_WEER/source/__06__Mk_06.R')
system.time(Mk_06("~/_WEER/TG_NONblend"))
source('~/_WEER/source/__06__Plt_06.R')
?sd()
source('~/_WEER/source/__02__Mk_02.R')
system.time(Mk_02("~/_WEER/TG_NONblend"))
source('~/_WEER/source/__02__Mk_02.R')
system.time(Mk_02("~/_WEER/TG_NONblend"))
source('~/_WEER/source/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TG_NONblend",H_range=c(0.5, 0.55)))
source('~/_WEER/source/__06__Mk_06.R')
system.time(Mk_06("~/_WEER/TG_NONblend"))
source('~/_WEER/source/__06__Plt_06.R')
system.time(   Plt_06("~/_WEER/TG_NONblend", # where is the _DoList file
N=20,  # how many plots must be made
Hreport = NULL,  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
?rnorm
aap = c(3, 5, 6)
aap>5
?na.omit
source('~/_WEER/source_2/__02__Mk_02.R')
source('~/_WEER/source_2/__02__Mk_02.R')
system.time(Mk_02("~/_WEER/TEST"))
source('~/_WEER/source_2/__02__Mk_02.R')
system.time(Mk_02("~/_WEER/TEST"))
system.time(Mk_02("~/_WEER/TEST"))
source('~/_WEER/source_2/__02__Mk_02.R')
system.time(Mk_02("~/_WEER/TEST"))
source('~/_WEER/source_2/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TEST",H_range=c(100, 300)))
source('~/_WEER/source_2/__06__Mk_06.R')
system.time(Mk_06("~/_WEER/TEST"))
source('~/_WEER/source_2/__06__Plt_06.R')
system.time(   Plt_06("~/_WEER/TEST", # where is the _DoList file
N=20,  # how many plots must be made
Hreport = NULL,  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
source('~/_WEER/source_2/__06__Plt_06.R')
source('~/_WEER/source_2/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TEST",H_range=c(100, 100000)))
source('~/_WEER/source_2/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TEST",H_range=c(100, 100000)))
source('~/_WEER/source_2/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TEST",H_range=c(20, 100000)))
source('~/_WEER/source_2/__06__Mk_06.R')
system.time(Mk_06("~/_WEER/TEST"))
source('~/_WEER/source_2/__06__Plt_06.R')
system.time(   Plt_06("~/_WEER/TEST", # where is the _DoList file
N=20,  # how many plots must be made
Hreport = NULL,  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
source('~/_WEER/source_2/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TEST",H_range=c(5, 20)))
source('~/_WEER/source_2/__06__Mk_06.R')
system.time(Mk_06("~/_WEER/TEST"))
source('~/_WEER/source_2/__06__Plt_06.R')
system.time(   Plt_06("~/_WEER/TEST", # where is the _DoList file
N=20,  # how many plots must be made
Hreport = NULL,  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_06("~/_WEER/TEST", # where is the _DoList file
N=20,  # how many plots must be made
Hreport = c(5, 50),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
source('~/_WEER/source_2/__05__Plt_05.R')
source('~/_WEER/source_2/__05__Plt_05.R')
source('~/_WEER/source_2/__05__Plt_05.R')
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = NULL,  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c("file", "screen") )  # c("file", "screen") for both
)
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = NULL,  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c("file", "screen") )  # c("file", "screen") for both
)
?ln
?log
?plot
?ylog
par()
source('~/_WEER/source_2/__05__Plt_05.R')
?par
source('~/_WEER/source_2/__05__Plt_05.R')
?par
source('~/_WEER/source_2/__05__Plt_05.R')
source('~/_WEER/source_2/__05__Plt_05.R')
source('~/_WEER/source_2/__05__Plt_05.R')
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(1, 100),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(1, 10),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(100, 1000),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(1000, 10000),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
source('~/_WEER/source_2/__02__Mk_02.R')
system.time(Mk_02("~/_WEER/TEST"))
source('~/_WEER/source_2/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TEST",H_range=c(200, 100000)))
source('~/_WEER/source_2/__06__Mk_06.R')
system.time(Mk_06("~/_WEER/TEST"))
source('~/_WEER/source_2/__05__Plt_05.R')
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(1000, 10000),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(2000, 5000),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(3000, 3500),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(100, 1000),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(300, 400),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(350, 570),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(350, 400),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(360, 370),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(450, 470),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(200, 100000),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(2000, 5000),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
source('~/_WEER/source_2/__06__Plt_06.R')
source('~/_WEER/source_2/__02__Mk_02.R')
system.time(Mk_02("~/_WEER/TEST"))
source('~/_WEER/source_2/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TEST",H_range=c(200, 100000)))
source('~/_WEER/source_2/__05__Plt_05.R')
source('~/_WEER/source_2/__06__Mk_06.R')
system.time(Mk_06("~/_WEER/TEST"))
system.time(Mk_02("~/_WEER/TEST"))
system.time(Mk_02("~/_WEER/TEST"))
system.time(Mk_05("~/_WEER/TEST",H_range=c(200, 100000)))
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = NULL,  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(Mk_06("~/_WEER/TEST"))
system.time(Mk_02("~/_WEER/TEST"))
system.time(Mk_05("~/_WEER/TEST",H_range=c(200, 100000)))
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = NULL,  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(Mk_06("~/_WEER/TEST"))
system.time(Mk_02("~/_WEER/TEST"))
system.time(Mk_02("~/_WEER/TEST"))
system.time(Mk_05("~/_WEER/TEST",H_range=c(200, 100000)))
source('~/_WEER/source_2/__02__Mk_02.R')
system.time(Mk_02("~/_WEER/TEST"))
source('~/_WEER/source_2/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TEST",H_range=c(50, 100000)))
system.time(Mk_05("~/_WEER/TEST",H_range=c(10, 100000)))
source('~/_WEER/source_2/__05__Mk_05.R')
system.time(Mk_05("~/_WEER/TEST",H_range=c(20, 100000)))
source('~/_WEER/source_2/__05__Plt_05.R')
Plt_05 <- function(ActualDataPath = getwd(), # in what directory find _DoList.csv
Hreport=c(100, 1000), # the H interrval tops reported on , NULL is all
dest=c("file", "screen")  ) { # where should the plots be
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = c(100, 1000),  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
}
source('~/_WEER/source_2/__05__Plt_05.R')
source('~/_WEER/source_2/__06__Mk_06.R')
system.time(Mk_06("~/_WEER/TEST"))
source('~/_WEER/source_2/__06__Plt_06.R')
system.time(Mk_02("~/_WEER/TEST"))
system.time(Mk_05("~/_WEER/TEST",H_range=c(50, 100000)))
system.time(   Plt_05("~/_WEER/TEST", # where is the _DoList file
Hreport = NULL,  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
system.time(Mk_06("~/_WEER/TEST"))
system.time(   Plt_06("~/_WEER/TEST", # where is the _DoList file
N=20,  # how many plots must be made
Hreport = NULL,  # NULL is all, c(H1, H2) H rport range of H1 to H2
dest =c( "screen") )  # c("file", "screen") for both
)
setwd("~/05_Reproducible_Research/RepData_PeerAssessment1")
?read.csv
read.csv(~\activity\activity.csv)
read.csv(~/activity/activity.csv)
read.csv("~/activity/activity.csv")
read.csv("~/activity/activity.csv")
getwd
getwd()
read.csv("activity/activity.csv")
read.csv("activity/activity.csv") -> data
head(data)
head(data,20)
head(data,200)
head(data,2000)
head(data,500)
nrow(data)
is.na(data[,1])
sum(is.na(data[,1]))
sum(is.na(data[,2]))
sum(is.na(data[,3]))
sum(is.na(data[,1]))
62 * 24 * 60 /5
tail(data)
24*60
data$date
data$date == "2012-11-04"
sum(data$date == "2012-11-04")
sum(data$date == "2012-11-08")
24*60/5
287 * 5
max(data[data$date == "2012-11-08",3])
min(data[data$date == "2012-11-08",3])
max(data[data$date == "2012-11-08",3]) /5
data[data$date == "2012-11-08",3]
24*60
sum(data$date == "2012-11-08")
max(data[data$date == "2012-11-08",3])
?data.frame
?floor
tail(data)
floor(data$interval/100)
data$interval - floor(data$interval/100) * 100
#
data.frame(data, hour = floor(data$interval/100)) -> data2
data.frame(data2, startmin = data2$interval - data2$hour * 100) -> data2
data.frame(data2, midtime = data2$hour + (data2$startmin + 2.5)/60) -> data2
head(data2, 5000)
?weekday
?weekdays
weekdays()
weekdays("2012-11-08")
#
?cdate
?date
?as.date
methodes(as)
?methodes(as)
?as.numeric
?as.time
?weekdays
?wday
?as.POSIXlt
weekdays(as.Date("2012-11-08"))
tail(data)
as.POSIXlt(data$date)
as.POSIXlt(data$date)$wday
ifelse(temp ==0 | temp == 6, "weekend", "weekday")
as.POSIXlt(data$date)$wday -> temp
ifelse(temp ==0 | temp == 6, "weekend", "weekday") -> temp
head(temp,2000)
class(temp)
?as.factor
as.factor(temp) -> temp
head(temp,2000)
class(temp)
class(data2)
class(data2[1,])
class(data2$hour)
class(data2$midtime)
?unzip
unzip("activity.zip")
head(data,3)
print(...)
tail(data,3)
head(data,3)
print("...")
tail(data,3)
From the rownumbers shown in the output we see there are `r nrow(data)` rows.
It should bee as expected  ((31 +30) * 24 * 60 ) / 5 = `r ((31 +30) * 24 * 60 ) / 5 `
head(data)
unique(data$date)
nrow(unique(data$date))
length(unique(data$date))
length(unique(data$date)) -> L
data.frame(date = unique(data$date) , stepspd = numeric(L)) -> datapd
na.omit(data) -> datastripped
for( d in unique(data$date) ) {
datastripped$steps[datastripped$date == d]  -> list
sum(list) / count(list) -> datapd$stepspd[datapd$date == d]
}
length(unique(data$date)) -> L
data.frame(date = unique(data$date) , stepspd = numeric(L)) -> datapd
na.omit(data) -> datastripped
for( d in unique(data$date) ) {
datastripped$steps[datastripped$date == d]  -> list
sum(list) / length(list) -> datapd$stepspd[datapd$date == d]
}
datapd
na.omit(data) -> data2
unique(data2$date) -> dates
data.frame(date = dates , stepstotal = numeric(length(dates))) -> datapd
for( d in dates) ) {
data2$steps[data2$date == d]  -> list
sum(list) -> datapd$stepstotal[datapd$date == d]
}
datapd
data2
na.omit(data) -> data2
unique(data2$date) -> dates
data.frame(date = dates , stepstotal = numeric(length(dates))) -> datapd
for( d in dates) ) {
sum(data2$steps[data2$date == d]) ->  datapd$stepstotal[datapd$date == d]
}
datapd
na.omit(data) -> data2
unique(data2$date) -> dates
data.frame(date = dates , stepstotal = numeric(length(dates))) -> datapd
for( d in dates)  {
sum(data2$steps[data2$date == d]) ->  datapd$stepstotal[datapd$date == d]
}
datapd
na.omit(data) -> data2
unique(data2$date) -> dates
data.frame(date = dates , stepstotal = numeric(length(dates)),
intervals = numeric(length(dates))) -> datapd
for( d in dates)  {
sum(data2$steps[data2$date == d]) ->  datapd$stepstotal[datapd$date == d]
length(data2$steps[data2$date == d]) ->  datapd$intervals[datapd$date == d]
}
datapd
There are `r length(unique(data$date))- length(unique(data2$date))` days with only NA values for all intervals.
hist(datapd$stepstotal)
?hist
hist(datapd$stepstotal, main="Histogram of total of steps per day", xlab="Steps in one day")
?plot
na.omit(data) -> data2
unique(data2$time) -> times
data.frame(time = times , stepstotal = numeric(length(times)),
intervals = numeric(length(times))) -> datapt
for( t in times)  {
sum(data2$steps[data2$time == t]) ->  datapt$stepstotal[datapt$time == t]
length(data2$steps[data2$time == t]) ->  datapt$intervals[datapt$time == t]
}
data.frame(datapt, stepsmeaninterval = datapt$stepstotal/datapt$intervals) -> datapt
plot(datapt$time, datapt$stepsmeaninterval, type="l")
plot(datapt$time, datapt$stepsmeaninterval, type="l")
datapt$time
datapt
na.omit(data) -> data2
unique(data2$time) -> times
data.frame(time = times , stepstotal = numeric(length(times)),
intervals = numeric(length(times))) -> datapt
for( t in times)  {
sum(data2$steps[data2$time == t]) ->  datapt$stepstotal[datapt$time == t]
length(data2$steps[data2$time == t]) ->  datapt$intervals[datapt$time == t]
}
data.frame(datapt, stepsmeaninterval = datapt$stepstotal/datapt$intervals) -> datapt
datapt
times
na.omit(data) -> data2
data2
plot(datapt$time, datapt$stepsmeaninterval, type="l")
